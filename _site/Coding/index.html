<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" lang="zh-CN">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="zh-CN">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="zh-CN">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
<html lang="zh-CN" class="js">
<!--<![endif]-->

<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-56ab70173edd5fd6" async="async"></script>

  

	

	
<head>
	<meta charset="utf-8">
	<title>代码 | Towdium's here</title>
	<meta name="description" content="personal blog of Towdium">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-Frame-Options" content="sameorigin">
	<!-- CSS -->
	<link rel="stylesheet" href="/css/main.css">
	<link rel='stylesheet' id='divi-style-css'  href="/css/style.css" type='text/css' media='all' />
	<link rel="stylesheet" href="/css/post.style.css">

	<script type='text/javascript' src="/js/jquery.js"></script>
	<script type='text/javascript' src="/js/soundmanager2-nodebug-jsmin.js"></script>

	<!--Favicon-->
	<link rel="icon" href="favicon.ico" type="image/x-icon"/>
	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	
	<link href="/favicon.ico" mce_href="favicon.ico" rel="bookmark" type="image/x-icon" /> 
	<link href="/favicon.ico" mce_href="favicon.ico" rel="icon" type="image/x-icon" /> 
	<link href="/favicon.ico" mce_href="favicon.ico" rel="shortcut icon" type="image/x-icon" /> 
	<!-- Canonical -->
	<link rel="canonical" href="https://towdium.github.io/Coding/">

	<!-- RSS -->
	<link rel="alternate" type="application/atom+xml" title="Towdium's here" href="https://towdium.github.io/feed.xml" />

	<!-- Font Awesome -->
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

	<!-- Google Fonts -->
	
	<link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic" rel="stylesheet" type="text/css">
	

	<!-- KaTeX -->
	
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min.css">
	<script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min.js"></script>
	

	<!-- Google Analytics -->
	
	<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-73095900-1', 'auto');
	ga('send', 'pageview');
	</script>
	

	<script type="text/javascript">
    var host = "";
    if ((host == window.location.host) && (window.location.protocol != "https:"))
        window.location.protocol = "https";
    </script>
     <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-73095900-1', 'auto');
ga('send', 'pageview');

</script>
 
</head>

	<body class="home blog et_pb_button_helper_class home-posts et_fixed_nav et_show_nav et_cover_background et_pb_gutter windows et_pb_gutters3 et_primary_nav_dropdown_animation_fade et_secondary_nav_dropdown_animation_fade et_pb_footer_columns4 et_header_style_left et_right_sidebar chrome">
		<div id="page-container">
    		<header id="main-header" data-height-onload="66">
	<div class="container clearfix et_menu_container">
		<div class="logo_container">
			<span class="logo_helper"></span>
			<a href="/">
				<!--img src="http://blog.ibireme.com/wp-content/uploads/2015/05/logo1.png" alt="Garan no dou" id="logo" data-height-percentage="54" /-->
				Towdium
			</a>
		</div>
		<div id="et-top-navigation" data-height="66" data-fixed-height="40">
			<nav id="top-menu-nav">
				<ul id="top-menu" class="nav">
					<li>
						<a class="page-link" href="/">
							Home
						</a>
					</li>
					
					
					
					
					<li>
						<a class="page-link" href="/About/">
							About
						</a>
					</li>
					
					
					
					<li>
						<a class="page-link" href="/Archives/">
							Archive
						</a>
					</li>
					
					
					
					
					
					<li>
						<a class="page-link" href="/Coding/">
							代码
						</a>
					</li>
					
					
					
					<li>
						<a class="page-link" href="/Daily/">
							日常
						</a>
					</li>
					
					
					
					
					
					
					
					
					
					
					
					
					
					<li>
						<a class="page-link" href="/Knowledge/">
							姿势
						</a>
					</li>
					
					
					
					
					
					
					
					
					
					
					
					
					<!-- Social icons from Font Awesome, if enabled -->
					<li>
						<a class="page-link" href="">Find Me</a>
						<ul class="children">












<li>
	<a href="https://github.com/Towdium" title="Follow on GitHub">
		<i class="fa fa-fw fa-github"></i>
	</a>
</li>



<li>
	<a href="https://weibo.com/u/5092127194" title="Follow on 微博">
		<i class="fa fa-fw fa-weibo"></i>
	</a>
</li>





















<li>
	<a href="https://twitter.com/towdium" title="Follow on Twitter">
		<i class="fa fa-fw fa-twitter"></i>
	</a>
</li>







<li>
	<a href="mailto:towdium@gmail.com" title="Email">
		<i class="fa fa-fw fa-envelope"></i>
	</a>
</li>
</ul>
					</li>
					
				</ul>
			</nav>

			<div id="et_mobile_nav_menu">
				<div class="mobile_nav closed">
					<span class="select_page"></span>
					<span class="mobile_menu_bar"></span>
				</div>
			</div>				
		</div> <!-- #et-top-navigation -->
	</div> <!-- .container -->
	<div class="et_search_outer">
		<div class="container et_search_form_container">
			<form role="search" method="get" class="et-search-form" action="https://towdium.github.io">
			<input type="search" class="et-search-field" placeholder="搜索 &hellip;" value="" name="s" title="搜索：" /></form>
			<span class="et_close_search_field"></span>
		</div>
	</div>
</header> <!-- #main-header -->

    		<div id="et-main-area">
      			<div class="home">
  <article class="feature-image" >
  	<div style="background-image: url('/img/bg.jpg')"/>
  	<header style="background-image: url('https://source.unsplash.com/category/nature/2600x500')">
    <h1 class="call-out-title">代码</h1>
    </header>
  </article>

<div class="posts">
    
        
            
	

				
		<div class="post-teaser">
		  <header>
		    <h1>
            <a id="post-link-trans" class="post-link" href="/blog/event-mode-in-java/">
		        关于java事件处理模式的纠结日常
		      </a>
		    </h1>
		    <p id="subtitletrans" class="subtitlecontainer">
		      <a class="subtitle">2015年03月31日</a>
		       | <a class="subtitle" href="/About/">Author</a>
		       | <a class="subtitle">  <i class="fa fa-book"></i>: <a href="/代码/">代码</a></a> <a class="subtitle">  <i class="fa fa-tag"></i>: <a href="/tags/java/">Java</a></a>
		    </p>
		  </header>
		  <div class="excerpt">
		  
		  
		    <h2>写在前边</h2>

<blockquote>
<p>想到这个空间还算是挺私人的，所以以后可能写东西之前就会更一点无聊的日常，不然搞得一本正经的有点怪怪的（笑）。这次要说的呢是我目前手上mod的开发问题。目前的开发呢已经逼近尾声了，在仅有的几个计划功能开发完之后，大概会补一个1.7的版本，如果我真的能搞定1.7的材质以及nei的api的话（雾）。这个就是我最近失踪的原因啦，而且因为又开学了有可能还会失踪一段时间。就是这样啦。</p>
</blockquote>

<p>不出意外，上边这段文字是我一个月之前刚开学的时候写的，现在已经逼近期中考试了。平时觉得牛逼的程序员都有点拖延症，所以就这样吧，不要在意。另外呢，现在mod的开发已经完成多时，1.7 的版本也已经更新多版了，1.9 尚在计划中。详情戳 <a href="http://minecraft.curseforge.com/projects/just-enough-calculation">这里</a>，我就不多说了。另外呢，我正在考虑限制文章的篇幅，800 字以内？嗯，就是这样。</p>

<h2>初探</h2>

<p>我们先来说一些铺垫的东西，何为事件：事件就是用户与程序界面的交互行为。鼠标点击，移动，键盘敲击，都可以算做事件。所以，最简单的程序，就算我们平时写命令行窗口也会有相关的事件，不过这种情况下处理都比较简单，大部分内容系统已经搞定了，我们只需要用类似于 <code>stdin</code> （C） 或者 <code>System.in</code> 这样的东西直接获取结果就好了。我们这里主要说 GUI 相关的事件处理，比如系统是怎样执行每一个按钮的点击，执行文本框的输入的。Java 中最广泛使用的是所谓 <code>ActionListener</code> 的系统，不过这里也会讲到一些其他场景的模型。</p>

<div align="center"><img src="/img/posts/event-mode-in-java_1.jpg"  alt="GUI 树形结构" width=50%/></div>

<p>对于大部分的界面而言，都会有一个树形的结构。在一个GUI中，我们有一个程序，持有多个窗口，每个窗口里边有多个面板，每个面板装着多个元件。这个模型有点像历史书上的封建制度“我附庸的附庸不是我的附庸”。在这个模型下，我们也可以这样说：“我持有的引用所持有的引用不是我持有的引用”。这话说着有点拗口，意思就是，当一个程序收到了点击的信号，他不可能直接找到那个被点击的元件然后直接激活。因为这个程序只持有若干个窗口的引用，而不直接持有被点击的元件。在这种情况下，所谓的“责任者模式”也就呼之欲出了。这里我必须要声明一下，我们这里的“树形”只是人为规定的结构，而不是一种硬性的规定。一个窗口直接持有元件的引用也很常见，但是在更宽泛的情况下，树形结构更易于项目的管理。</p>

<h2>责任者模式</h2>

<p>这是一个被广泛使用的事件模型，上层组件收到时间信息的时候，就将事件内容转交给下一层对象，下一层对象处理完事件后，将结果返回给上层对象。如果还不是很确切的话，看代码好了：</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Component</span><span class="o">{</span>
    <span class="kt">boolean</span> <span class="n">onClick</span><span class="o">(</span><span class="kt">int</span> <span class="n">mouseX</span><span class="o">,</span> <span class="kt">int</span> <span class="n">mouseY</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Panel</span> <span class="kd">extends</span> <span class="n">Component</span><span class="o">{</span>
    <span class="kd">public</span> <span class="n">list</span><span class="o">&lt;</span><span class="n">Component</span><span class="o">&gt;</span> <span class="n">components</span><span class="o">;</span>  <span class="c1">// 存储所有下层对象的应用</span>

    <span class="nd">@Override</span>
    <span class="kt">boolean</span> <span class="n">onClick</span><span class="o">(</span><span class="kt">int</span> <span class="n">mouseX</span><span class="o">,</span> <span class="kt">int</span> <span class="n">mouseY</span><span class="o">){</span>    <span class="c1">// 处理点击事件</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Component</span> <span class="n">comp</span> <span class="o">:</span> <span class="n">components</span><span class="o">){</span>   <span class="c1">// 逐个调用下层对象进行事件处理</span>
            <span class="k">if</span><span class="o">(</span><span class="n">comp</span><span class="o">.</span><span class="na">onClick</span><span class="o">(</span><span class="n">mouseX</span><span class="o">,</span> <span class="n">mouseY</span><span class="o">)){</span>
                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>    <span class="c1">// 如果事件被处理，返回结果</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>   <span class="c1">// 如果事件未被处理，返回结果</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>这一段代码只是一个抽象，只举了鼠标点击事件的传递，实际情况下，实现可能更为复杂，但是原理是一致的。</p>

<h2>监听者模式</h2>

<p>上边我们已经说了上层对象触发下层对象的情况。我们再来说下层对象的事件触发上层对象动作的情况。有人可能要问了：下层对象为什么会触发上层对象呢？答案很明显，每一次鼠标点击的事件都会经由上级对象转交给下级对象，但是这就结束了么？答案显然是否定的。按钮被触发之后，这一结果还会传递给其它组件，进行相应的反馈。</p>

<p>当然这种模式也有很多实现方式，先说最简单的，下层对象直接触发上层对象处理。先来看代码：</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Component</span><span class="o">{</span>
    <span class="kt">boolean</span> <span class="n">onClick</span><span class="o">(</span><span class="kt">int</span> <span class="n">mouseX</span><span class="o">,</span> <span class="kt">int</span> <span class="n">mouseY</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Panel</span> <span class="kd">extends</span> <span class="n">Component</span><span class="o">{</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Component</span><span class="o">&gt;</span> <span class="n">components</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="n">Panel</span><span class="o">(){</span>
        <span class="n">components</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Button</span><span class="o">(</span><span class="k">this</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kt">void</span> <span class="n">actionPerformed</span><span class="o">(){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"事件被处理啦！"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// 顺次触发所有组件并反馈结果</span>
    <span class="nd">@Override</span>
    <span class="kt">boolean</span> <span class="n">onClick</span><span class="o">(</span><span class="kt">int</span> <span class="n">mouseX</span><span class="o">,</span> <span class="kt">int</span> <span class="n">mouseY</span><span class="o">){</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Component</span> <span class="n">comp</span> <span class="o">:</span> <span class="n">components</span><span class="o">){</span>
            <span class="k">if</span><span class="o">(</span><span class="n">comp</span><span class="o">.</span><span class="na">onClick</span><span class="o">(</span><span class="n">mouseX</span><span class="o">,</span> <span class="n">mouseY</span><span class="o">)){</span>
                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Button</span> <span class="kd">extends</span> <span class="n">Component</span><span class="o">{</span>
    <span class="n">Panel</span> <span class="n">parent</span><span class="o">;</span>   <span class="c1">// 存放上级对象</span>

    <span class="n">Button</span><span class="o">(</span><span class="n">Panel</span> <span class="n">p</span><span class="o">){</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">p</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">onClick</span><span class="o">(</span><span class="kt">int</span> <span class="n">mouseX</span><span class="o">,</span> <span class="kt">int</span> <span class="n">mouseY</span><span class="o">){</span>  <span class="c1">// 处理点击事件</span>
        <span class="n">parent</span><span class="o">.</span><span class="na">actionPerformed</span><span class="o">();</span>   <span class="c1">// 调用上级的处理函数</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>感觉代码已经难以避免的变长了（笑）。从代码的长度也可以比较明白的显示出结构的复杂程度。在这种情况下，下层对象直接持有上层引用，一旦接收到事件，就可以直接调用。但是这样弊端也很明显，这种触发形式是内建在代码里的，所以拓展性很不好。于是我们将子类接收到事件时需要进行的动作装在一个列表里，并且允许其他类来增减，这就是普遍使用的监听者模型。插一段代码吧：</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Component</span><span class="o">{</span>
    <span class="kt">boolean</span> <span class="n">onClick</span><span class="o">(</span><span class="kt">int</span> <span class="n">mouseX</span><span class="o">,</span> <span class="kt">int</span> <span class="n">mouseY</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">interface</span> <span class="nc">ActionListener</span><span class="o">{</span>
    <span class="kt">void</span> <span class="n">actionPerformed</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Panel</span> <span class="kd">extends</span> <span class="n">Component</span><span class="o">{</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Component</span><span class="o">&gt;</span> <span class="n">components</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="c1">// 构造函数中添加按钮</span>
    <span class="n">Panel</span><span class="o">(){</span>
        <span class="n">components</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Button</span><span class="o">(</span><span class="k">this</span><span class="o">)){</span>
            <span class="o">{</span>
                <span class="c1">// 给按钮添加监听器</span>
                <span class="n">actionListeners</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">ActionListener</span><span class="o">(){</span>
                    <span class="nd">@Override</span>
                    <span class="kt">void</span> <span class="n">actionPerformed</span><span class="o">(){</span>
                        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"发现事件！"</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">});</span>
            <span class="o">}</span>
        <span class="o">};</span>
    <span class="o">}</span>

    <span class="c1">// 顺次触发所有组件并反馈结果</span>
    <span class="nd">@Override</span>
    <span class="kt">boolean</span> <span class="n">onClick</span><span class="o">(</span><span class="kt">int</span> <span class="n">mouseX</span><span class="o">,</span> <span class="kt">int</span> <span class="n">mouseY</span><span class="o">){</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Component</span> <span class="n">comp</span> <span class="o">:</span> <span class="n">components</span><span class="o">){</span>
            <span class="k">if</span><span class="o">(</span><span class="n">comp</span><span class="o">.</span><span class="na">onClick</span><span class="o">(</span><span class="n">mouseX</span><span class="o">,</span> <span class="n">mouseY</span><span class="o">)){</span>
                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Button</span> <span class="kd">extends</span> <span class="n">Component</span><span class="o">{</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">ActionListener</span><span class="o">&gt;</span> <span class="n">actionListeners</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="n">onClick</span><span class="o">(</span><span class="kt">int</span> <span class="n">mouseX</span><span class="o">,</span> <span class="kt">int</span> <span class="n">mouseY</span><span class="o">){</span>  <span class="c1">// 处理点击事件</span>
        <span class="k">for</span><span class="o">(</span><span class="n">ActionListener</span> <span class="n">listener</span> <span class="o">:</span> <span class="n">actionListeners</span><span class="o">){</span>
            <span class="n">listener</span><span class="o">.</span><span class="na">actionPerformed</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>在这种模式里，监听类多数为上层类的内部类（普通内部类，匿名内部类，lamda表达式的匿名内部类均在此列，不细讲了），上层类将监听类塞入下层对象的监听列表中，下层对象每当接收到输入信号时，就把这一信号传递给监听列表中的所有监听器，经由监听器传递给上层对象。比起上一种实现方式，监听器模型显然份量更重，不过它也实现了更好的拓展性:我们可以自由改动组件被触发时的行为。这里我们就看出程序设计的基本原理：效率与拓展性不可得兼。</p>

<h2>事件总线模型</h2>

<p>如果你还没有被我繁琐的语言逼疯的话，那么恭喜你，我们重点的内容就要开始了。上边我们一直在说树形结构以内的事件传递，这其实是比较好处理的，因为获取引用还不至于是一件非常困难的事。但是，如果我们需要在事件的发生和执行中构造一种松耦合的关系，问题就有些复杂了。比如说，我有一个数据库，里边有很多用户，我需要监听用户的某些活动。这你可能会说，在用户对象构造的时候直接挂上监听器不就好了么？确实是这样，但是如果我要开发的是一个插件，并不能修改原有的构造代码，我应该怎么做呢？我们就必须引入事件总线模型了，在程序设计模式中，比较相似的是命令模式。</p>

<p>在这一结构中，系统维护着一套事件总线，一旦有事件发生，对象都将发生的事打包发布到事件总线，再由事件总线转交给登记的订阅者。这一模式最大的优势在于他是基于类的，订阅者只需要告知总线自己订阅的事件类型，而不必要获得事件的发布者。在总线转交事件的过程中，发布者的引用也被一并转交，供监听者进行处理，这样，拿不到引用的问题就被解决了。不过，我们的结构不得不被再一次扩大（笑）。不过好在我们这次的内容已经跟 <code>Panel</code> 类没什么关系了，所以我们的代码也许能少一些。</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Component</span><span class="o">{</span>
    <span class="kt">boolean</span> <span class="n">onClick</span><span class="o">(</span><span class="kt">int</span> <span class="n">mouseX</span><span class="o">,</span> <span class="kt">int</span> <span class="n">mouseY</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">interface</span> <span class="nc">ActionListener</span><span class="o">{</span>
    <span class="kt">void</span> <span class="n">actionPerformed</span><span class="o">(</span><span class="n">Event</span> <span class="n">e</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Event</span><span class="o">{</span>
    <span class="n">Event</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">,</span> <span class="n">Component</span> <span class="n">trig</span><span class="o">){</span>
        <span class="n">mouseX</span> <span class="o">=</span> <span class="n">x</span><span class="o">;</span>
        <span class="n">mouseY</span> <span class="o">=</span> <span class="n">y</span><span class="o">;</span>
        <span class="n">trigger</span> <span class="o">=</span> <span class="n">trig</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kt">int</span> <span class="n">mouseX</span><span class="o">;</span> <span class="c1">// 鼠标信息</span>
    <span class="kt">int</span> <span class="n">mouseY</span><span class="o">;</span>
    <span class="n">Component</span> <span class="n">trigger</span><span class="o">;</span>  <span class="c1">// 触发者引用</span>
<span class="o">}</span>

<span class="kd">static</span> <span class="kd">class</span> <span class="nc">EventBus</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">ActionListener</span><span class="o">&gt;</span> <span class="n">actionListeners</span><span class="o">;</span>

    <span class="kd">static</span> <span class="kt">void</span> <span class="n">postEvent</span><span class="o">(</span><span class="n">Event</span> <span class="n">e</span><span class="o">){</span>
        <span class="k">for</span><span class="o">(</span><span class="n">ActionListener</span> <span class="n">listener</span> <span class="o">:</span> <span class="n">actionListeners</span><span class="o">){</span>
            <span class="n">listener</span><span class="o">.</span><span class="na">actionPerformed</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Button</span> <span class="kd">extends</span> <span class="n">Component</span><span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="n">onClick</span><span class="o">(</span><span class="kt">int</span> <span class="n">mouseX</span><span class="o">,</span> <span class="kt">int</span> <span class="n">mouseY</span><span class="o">){</span>  <span class="c1">// 处理点击事件</span>
        <span class="n">EventBus</span><span class="o">.</span><span class="na">postEvent</span><span class="o">(</span><span class="k">new</span> <span class="n">Event</span><span class="o">(</span><span class="n">mouseX</span><span class="o">,</span> <span class="n">mouseY</span><span class="o">,</span> <span class="k">this</span><span class="o">));</span>  <span class="c1">// 发布事件</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>这段代码看起来似乎不长，但是执行起来是比上边的模式效率低一些的。设想一下，在这个数据库里，如果用户有大量的事件触发，同时挂载的订阅者又很多，整个事件总线就会疲劳不堪。因为事件总线模式是通过静态的事件总线类来中转，每当有事件触发，他就要遍历所有的订阅者来发送事件，而每个订阅者都要处理一通，这样的效率是不高的，而且在这些事件中，有相当一部分对于监听者是没用的，会被过滤掉，在这个过滤过程中，又会损失一部分性能。但是在这种复杂情况下，事件总线几乎是仅有的选择了，这就能看出事件总线的特点：关注某一类事件，而不关注某一个对象；良好的可扩展性。现在大部分程序都会提供插件开发的接口，这样的特性就尤为重要了。</p>

<p>我这里的总线只是给出的最小可运行体积，实际应用中可能会有相当复杂的结构出现，但是原理仍然是一致的。另外呢，想到我几个月之前在朋友圈说的那句话“总线=Bus=公交车”，这是因为这个事件是在所有订阅者中传阅的，每个订阅者都可以进行修改，这也就意味着等传给最后一个订阅者手中的时候，这个事件可能已经被篡改的面目全非了（污），甚至某些总线会在发布之后把事件返回给发布者，请自行脑补发布者的内心波动（此处应有表情：我内心毫无波动，甚至还想笑）。大概就是这样吧（笑）。</p>

<h2>写在后边</h2>

<p>看了这么多不同的模式，想必读者对于程序设计的思路也有一些理解了，最明显的特征还是那句话：性能与功能不可得兼。根据不同的需求选择需要的模式才是一个优秀程序员应该做的，盲目追求功能而牺牲性能并不是好的做法。还有，说好的限制篇幅呢！对于这种事情，我能说的只有“妈的智障”！</p>

<p>事件总线参考：<a href="http://blog.hakugyokurou.net/?p=225">szszss的博客：基于FML的MinecraftMod制作教程(1)-Forge的事件系统</a></p>

		    <p>
		    <a class="text" href="/blog/event-mode-in-java/">
		      Continue Reading...
		    </a>
		    </p>
		  
		  </div>
		</div>
        
            
	

				
		<div class="post-teaser">
		  <header>
		    <h1>
            <a id="post-link-trans" class="post-link" href="/blog/usage-of-enum-in-java/">
		        浅析 Java 中 enum 枚举与 C 的异同以及使用方法
		      </a>
		    </h1>
		    <p id="subtitletrans" class="subtitlecontainer">
		      <a class="subtitle">2015年01月30日</a>
		       | <a class="subtitle" href="/About/">Author</a>
		       | <a class="subtitle">  <i class="fa fa-book"></i>: <a href="/代码/">代码</a></a> <a class="subtitle">  <i class="fa fa-tags"></i>: <a href="/tags/java/">Java</a>, <a href="/tags/c/">C</a></a>
		    </p>
		  </header>
		  <div class="excerpt">
		  
		  
		    <h2>enum 的前世今生 —— C 与 Java</h2>

<p>相信有不少小伙伴儿们刚开始接触 enum （枚举）的时候和笔者的想法是一样的：
“我知道 Java 里边结构主要就是 类，方法，变量，这个枚举是个什么玩意？”
这个问题现在解决可能还为时过早，我们不妨先看一段 C 的代码，
来看看 enum 在 C 中是怎样的存在。没有 C 基础的小伙伴儿也别激动，
我尽量把它写的简单一些，没有基础应该也能看懂，或者直接读下一节也不会影响整体内容的理解。
注意，作为一个面向过程的语言，
C 语言是没有类的，取而代之的是 structure （结构体），
你可以把它理解成只有变量没有方法的类,我们在后边会用到。  </p>
<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;
</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="cm">/* 
    * 新建 enum 类型的变量 myLeverState 表示拉杆状态
    * 同时，myLeverState 受前边的内容限制， 
    * 需要表示 LeverState，且内容必须是 ON 或 OFF 之一 
    */</span>
    <span class="k">enum</span> <span class="n">LeverState</span><span class="p">{</span> <span class="n">OFF</span><span class="p">,</span> <span class="n">ON</span> <span class="p">}</span> <span class="n">myLeverState</span><span class="p">;</span>
    <span class="n">myLeverState</span> <span class="o">=</span> <span class="n">ON</span><span class="p">;</span>  <span class="cm">/* 将变量赋值为 ON */</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="n">myLeverState</span><span class="p">);</span> 
    <span class="cm">/* 输出结果：1 */</span>
    <span class="cm">/* C语言把 ON 和 OFF 翻译成了整数，按照顺序，OFF为0，ON为1 */</span>
<span class="p">}</span>
</code></pre></div>
<p>在这一段代码里，我们可以相当清楚的接收到 C 语言设计的时候的思想：</p>

<blockquote>
<p>enum 是一种特殊类型的变量，它的值是受限定的。</p>
</blockquote>

<p>但是这句话未必经得起考究。很明显，变量声明时，声明 enum 的方式和其它变量并不一致,
这也就意味着，enum在本质上可能未必这么简单：</p>
<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="kt">int</span> <span class="n">i</span><span class="p">;</span>  <span class="cm">/* 整型声明 */</span>
<span class="kt">float</span> <span class="n">f</span><span class="p">;</span>  <span class="cm">/* 浮点型声明 */</span>
<span class="k">enum</span> <span class="n">Type</span><span class="p">{</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span> <span class="p">}</span> <span class="n">e</span><span class="p">;</span>  <span class="cm">/* 枚举型声明 */</span>
</code></pre></div>
<p>马脚很明显，我就想问你这里多出来的一段 <code>Type{ A, B, C }</code> 是几个意思？
鉴于C语言中大括号的使用并不多，
我们很快就想到了 structure 的定义。如果我们要刻意将 structure 的声明逼近 enum，
代码也可以这样写：</p>
<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;stdio.h&gt;
</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="cm">/* 新建 LeverState 类型的结构体，新建一个实例为 leverState */</span>
    <span class="k">struct</span> <span class="n">LeverState</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">OFF</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ON</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span> <span class="n">leverState</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">myLeverState</span> <span class="o">=</span> <span class="n">leverState</span><span class="p">.</span><span class="n">ON</span><span class="p">;</span>   <span class="cm">/* 给整型变量赋值为 ON */</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="n">myLeverState</span><span class="p">);</span>   <span class="cm">/* 结果仍是1 */</span>
<span class="p">}</span>
</code></pre></div>
<p>对比一下，上下两段代码完全就是激似好么！上边的代码可能和我们平时的习惯有所出入，
但是完全是可以编译执行的。所以，我们不如这样说：</p>

<blockquote>
<p>C 语言中 enum 在表层上是一种特殊的变量类型，在底层的实现可能更接近 structure</p>
</blockquote>

<p>我并没有研究过 C 语言的底层，但是这一推测至少是有理有据的。
同时，他们之间还存在着以下的区别：</p>

<ul>
<li>enum 的内容是不可更改的，而 structure 里的变量可以随时更改</li>
<li>enum 中的变量类型是一致的（从第一段代码我们可以看出所有的值其实都被解释为了整型数字），
而 structure 里可以存在不同类型的变量</li>
<li>enum 的每个实例都只表示一种情况（一个变量的值），而 structure 的实例包含所有变量</li>
</ul>

<p>所以，虽然 enum 和 structure 是非常相似的，他们的用途却完全不同。
但是这一发现还请暂时记住，在 java 中，相似的情况也将会出现。
不过此时 structure 的角色将由 java 中的增强版 —— 类 来代替。</p>

<h2>enum 在 java 中的用法</h2>

<p>我们终于离开了让人蛋疼的怀旧内容，能开始说一点儿正经事了。
在开始之前，回想一下我们之前的结论：
C 语言中的 enum 与 structure 具有相当高的相似性。
那么，java 中的 enum 是否就会相应的和类具有一定的相似性呢？
答案是肯定的，而且理论上来讲，对编译器而言，enum 实际上就是 class。
所以在接下来的内容中，从 class 的角度理解 enum 的一些语法， 会带来一些帮助。<br>
先来看一段代码吧，继续用我们的拉杆的模型：</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Lever</span> <span class="o">{</span>

    <span class="kd">enum</span> <span class="n">State</span><span class="o">{</span><span class="n">ON</span><span class="o">,</span> <span class="n">OFF</span><span class="o">};</span>    <span class="c1">// 声明一个enum，可能出现的情况有 ON 和 OFF</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="n">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">State</span> <span class="n">myLeverState</span> <span class="o">=</span> <span class="n">State</span><span class="o">.</span><span class="na">ON</span><span class="o">;</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">myLeverState</span><span class="o">);</span>  <span class="c1">// 打印结果 ON</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>如果这一段代码还不够简洁易懂的话，不如参考下边这段代码。鉴于 java 多样的修饰符，
我们已经几乎可以完全用 class 的方式实现 enum 了，这在 C 语言里是做不到的：</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Lever</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">State</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">State</span> <span class="n">ON</span> <span class="o">=</span> <span class="k">new</span> <span class="n">State</span><span class="o">(</span><span class="s">"ON"</span><span class="o">);</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">State</span> <span class="n">OFF</span> <span class="o">=</span> <span class="k">new</span> <span class="n">State</span><span class="o">(</span><span class="s">"OFF"</span><span class="o">);</span>

        <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>  <span class="c1">// enum的名字</span>

        <span class="kd">private</span> <span class="n">State</span><span class="o">(</span><span class="n">String</span> <span class="n">str</span><span class="o">){</span>   <span class="c1">// 构造方法</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">str</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="n">toString</span><span class="o">(){</span>
            <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="n">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">State</span> <span class="n">myLeverState</span> <span class="o">=</span> <span class="n">State</span><span class="o">.</span><span class="na">ON</span><span class="o">;</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">myLeverState</span><span class="o">);</span>    <span class="c1">// 打印结果仍然是 ON</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>可以看到，我们 main 方法中的内容并没有变化。通过类 State ，
我们模拟了 enum State 的工作方式。
实际上，真正的 enum 实现和我们这里给出的代码是很相似的，
只是 java 提供了更多的方法便于我们使用。
在运行时，每个 enum 都是一个 Enum 类的子类，
从而继承了 Enum 类的方法。</p>

<p>从这个例子来看，我们已经可以得到一些 enum 的特点了：</p>

<ul>
<li>静态且不可变更</li>
<li>类中包含自身的常量对象，即可能出现的值</li>
<li>私有构造方法，防止 enum 被拓展。</li>
</ul>

<p>说到这里，如果你对于 enum 本质是 class 这件事还不是十分确信的话，
我们再来看一段代码：</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Lever</span> <span class="o">{</span>

    <span class="kd">enum</span> <span class="n">State</span><span class="o">{</span> <span class="n">ON</span><span class="o">,</span> <span class="n">OFF</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="n">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">State</span> <span class="n">myLeverState</span> <span class="o">=</span> <span class="n">State</span><span class="o">.</span><span class="na">ON</span><span class="o">.</span><span class="na">OFF</span><span class="o">;</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">myLeverState</span><span class="o">);</span> <span class="c1">// 打印结果 OFF</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>在这里， <code>State.ON.OFF</code> 就是通过成员变量调用类的常量，执行结果没有任何问题。
尽管 IDE 在这里给我报了一个警告，问我调用这个变量为什么要绕这个大圈子（笑）。</p>

<h2>enum 的应用 —— 与类的常量的比较</h2>

<p>我们到 java 源代码里随便找点东西看看，嗯，就你了 Color （在 java.awt 下）。
一打开我们就发现满眼都是常量,一下子占了两百行。我摘抄一段源码感受一下：</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Color</span> <span class="kd">implements</span> <span class="n">Paint</span><span class="o">,</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">Serializable</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kd">static</span> <span class="n">Color</span> <span class="n">white</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">255</span><span class="o">,</span> <span class="mi">255</span><span class="o">);</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kd">static</span> <span class="n">Color</span> <span class="n">WHITE</span> <span class="o">=</span> <span class="n">white</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kd">static</span> <span class="n">Color</span> <span class="n">lightGray</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">192</span><span class="o">,</span> <span class="mi">192</span><span class="o">,</span> <span class="mi">192</span><span class="o">);</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kd">static</span> <span class="n">Color</span> <span class="n">LIGHT_GRAY</span> <span class="o">=</span> <span class="n">lightGray</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kd">static</span> <span class="n">Color</span> <span class="n">gray</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">128</span><span class="o">,</span> <span class="mi">128</span><span class="o">,</span> <span class="mi">128</span><span class="o">);</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kd">static</span> <span class="n">Color</span> <span class="n">GRAY</span> <span class="o">=</span> <span class="n">gray</span><span class="o">;</span>
    <span class="c1">// 省略 n 多行</span>
</code></pre></div>
<p>虽说也没什么不对的，不过总觉得不太好。如果我们用枚举来做呢？</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Color</span> <span class="o">{</span>
    <span class="kd">enum</span> <span class="n">Colors</span><span class="o">{</span>
        <span class="n">RED</span><span class="o">,</span> <span class="n">BLUE</span><span class="o">,</span> <span class="n">YELLOW</span><span class="o">,</span> <span class="n">GREEN</span><span class="o">,</span> <span class="n">LIGHT_GREY</span><span class="o">,</span> 
        <span class="n">DARK_GREY</span><span class="o">,</span> <span class="n">GREY</span><span class="o">,</span> <span class="n">BLACK</span><span class="o">,</span> <span class="n">WHITE</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>有木有觉得眼前清静了许多呢（笑）。</p>

<p>不过这样也不是完全解决问题的，或者说，完全不解决问题。
比如一个函数要求参数是 Color 类的，
那么 <code>Color.Colors.YELLOW</code> 这样的玩意儿是完全不管用的，
因为人家要的是 Color 类，我们给的却是 Colors 类，换句话说，是 Enum 的子类。</p>

<p>这个时候 enum 的特征就很明显了，他只是一个标记，本身是不装内容的。
如果我们硬要用 enum 来做呢，也不是不可以，下面提供两个思路：</p>

<p>思路一：</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Color</span> <span class="o">{</span>

    <span class="kd">enum</span> <span class="n">Colors</span><span class="o">{</span>
        <span class="n">RED</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">),</span>
        <span class="n">YELLO</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">255</span><span class="o">,</span> <span class="mi">0</span><span class="o">),</span>
        <span class="n">BLUE</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">255</span><span class="o">),</span>
        <span class="n">GREEN</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">255</span><span class="o">,</span> <span class="mi">0</span><span class="o">),</span>
        <span class="n">GREY</span><span class="o">(</span><span class="mi">128</span><span class="o">,</span> <span class="mi">128</span><span class="o">,</span> <span class="mi">128</span><span class="o">),</span>
        <span class="n">LIGHT_GREY</span><span class="o">(</span><span class="mi">192</span><span class="o">,</span> <span class="mi">192</span><span class="o">,</span> <span class="mi">192</span><span class="o">),</span>
        <span class="n">DARK_GREY</span><span class="o">(</span><span class="mi">64</span><span class="o">,</span> <span class="mi">64</span><span class="o">,</span> <span class="mi">64</span><span class="o">),</span>
        <span class="n">BLACK</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">),</span>
        <span class="n">WHITE</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span><span class="mi">255</span><span class="o">,</span><span class="mi">255</span><span class="o">);</span>

        <span class="kd">private</span> <span class="n">Color</span> <span class="n">color</span><span class="o">;</span>  <span class="c1">// 在 enum 内部保存一个 Color 类的实例</span>

        <span class="kd">private</span> <span class="n">Colors</span> <span class="o">(</span><span class="kt">int</span> <span class="n">r</span><span class="o">,</span> <span class="kt">int</span> <span class="n">g</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">){</span>  <span class="c1">// 新建 enum 时就将这个 Color 赋值</span>
            <span class="n">color</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="n">r</span><span class="o">,</span> <span class="n">g</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="n">Color</span> <span class="n">toColor</span><span class="o">(){</span>   <span class="c1">// 需要时通过特定的函数调用</span>
            <span class="k">return</span> <span class="n">color</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kt">int</span> <span class="n">red</span><span class="o">,</span><span class="n">green</span><span class="o">,</span><span class="n">blue</span><span class="o">;</span>

    <span class="n">Color</span><span class="o">(</span><span class="kt">int</span> <span class="n">r</span><span class="o">,</span> <span class="kt">int</span> <span class="n">g</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">){</span>
        <span class="n">red</span> <span class="o">=</span> <span class="n">r</span><span class="o">;</span>
        <span class="n">green</span> <span class="o">=</span> <span class="n">g</span><span class="o">;</span>
        <span class="n">blue</span> <span class="o">=</span> <span class="n">b</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="n">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">Color</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Color</span><span class="o">.</span><span class="na">Colors</span><span class="o">.</span><span class="na">BLUE</span><span class="o">.</span><span class="na">toColor</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>思路二：</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Color</span> <span class="o">{</span>

    <span class="kd">enum</span> <span class="n">Colors</span><span class="o">{</span>
        <span class="n">RED</span><span class="o">,</span> <span class="n">BLUE</span><span class="o">,</span> <span class="n">YELLOW</span><span class="o">,</span> <span class="n">GREEN</span><span class="o">,</span> <span class="n">LIGHT_GREY</span><span class="o">,</span> <span class="n">DARK_GREY</span><span class="o">,</span> <span class="n">GREY</span><span class="o">,</span> <span class="n">BLACK</span><span class="o">,</span> <span class="n">WHITE</span><span class="o">;</span>

        <span class="kd">public</span> <span class="n">Color</span> <span class="n">toColor</span><span class="o">(){</span>   <span class="c1">// 需要时新建并返回对象</span>
            <span class="k">switch</span> <span class="o">(</span><span class="k">this</span><span class="o">){</span>
                <span class="k">case</span> <span class="nl">RED:</span> <span class="k">return</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
                <span class="k">case</span> <span class="nl">YELLOW:</span> <span class="k">return</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">255</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
                <span class="k">case</span> <span class="nl">BLUE:</span> <span class="k">return</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">255</span><span class="o">);</span>
                <span class="k">case</span> <span class="nl">GREEN:</span> <span class="k">return</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">255</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
                <span class="k">case</span> <span class="nl">LIGHT_GREY:</span> <span class="k">return</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">192</span><span class="o">,</span> <span class="mi">192</span><span class="o">,</span> <span class="mi">192</span><span class="o">);</span>
                <span class="k">case</span> <span class="nl">DARK_GREY:</span> <span class="k">return</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">64</span><span class="o">,</span> <span class="mi">64</span><span class="o">,</span> <span class="mi">64</span><span class="o">);</span>
                <span class="k">case</span> <span class="nl">GREY:</span> <span class="k">return</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">128</span><span class="o">,</span> <span class="mi">128</span><span class="o">,</span> <span class="mi">128</span><span class="o">);</span>
                <span class="k">case</span> <span class="nl">BLACK:</span> <span class="k">return</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
                <span class="k">case</span> <span class="nl">WHITE:</span> <span class="k">return</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">255</span><span class="o">,</span> <span class="mi">255</span><span class="o">);</span>
                <span class="k">default</span><span class="o">:</span> <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kt">int</span> <span class="n">red</span><span class="o">,</span><span class="n">green</span><span class="o">,</span><span class="n">blue</span><span class="o">;</span>

    <span class="n">Color</span><span class="o">(</span><span class="kt">int</span> <span class="n">r</span><span class="o">,</span> <span class="kt">int</span> <span class="n">g</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">){</span>
        <span class="n">red</span> <span class="o">=</span> <span class="n">r</span><span class="o">;</span>
        <span class="n">green</span> <span class="o">=</span> <span class="n">g</span><span class="o">;</span>
        <span class="n">blue</span> <span class="o">=</span> <span class="n">b</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="n">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">Color</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Color</span><span class="o">.</span><span class="na">Colors</span><span class="o">.</span><span class="na">BLUE</span><span class="o">.</span><span class="na">toColor</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>思路三：</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">java.util.EnumMap</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Color</span> <span class="o">{</span>

    <span class="kd">enum</span> <span class="n">EnumColors</span><span class="o">{</span><span class="n">RED</span><span class="o">,</span> <span class="n">BLUE</span><span class="o">,</span> <span class="n">YELLOW</span><span class="o">,</span> <span class="n">GREEN</span><span class="o">,</span> <span class="n">LIGHT_GREY</span><span class="o">,</span> <span class="n">DARK_GREY</span><span class="o">,</span> <span class="n">GREY</span><span class="o">,</span> <span class="n">BLACK</span><span class="o">,</span> <span class="n">WHITE</span><span class="o">}</span>

    <span class="c1">// 建立 EnumMap 来存储 EnumColors 与 Color 的对应关系</span>
    <span class="kd">static</span> <span class="n">EnumMap</span><span class="o">&lt;</span><span class="n">EnumColors</span><span class="o">,</span> <span class="n">Color</span><span class="o">&gt;</span> <span class="n">colors</span> <span class="o">=</span> <span class="k">new</span> <span class="n">EnumMap</span><span class="o">&lt;</span><span class="n">EnumColors</span><span class="o">,</span> <span class="n">Color</span><span class="o">&gt;(</span><span class="n">EnumColors</span><span class="o">.</span><span class="na">class</span><span class="o">){</span>
        <span class="c1">// 通过匿名内部类复写构造方法，实现内容的初始化</span>
        <span class="o">{</span>
            <span class="n">put</span><span class="o">(</span><span class="n">EnumColors</span><span class="o">.</span><span class="na">RED</span><span class="o">,</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">));</span>
            <span class="n">put</span><span class="o">(</span><span class="n">EnumColors</span><span class="o">.</span><span class="na">YELLOW</span><span class="o">,</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">255</span><span class="o">,</span> <span class="mi">0</span><span class="o">));</span>
            <span class="n">put</span><span class="o">(</span><span class="n">EnumColors</span><span class="o">.</span><span class="na">BLUE</span><span class="o">,</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">255</span><span class="o">));</span>
            <span class="n">put</span><span class="o">(</span><span class="n">EnumColors</span><span class="o">.</span><span class="na">GREEN</span><span class="o">,</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">255</span><span class="o">,</span> <span class="mi">0</span><span class="o">));</span>
            <span class="n">put</span><span class="o">(</span><span class="n">EnumColors</span><span class="o">.</span><span class="na">LIGHT_GREY</span><span class="o">,</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">192</span><span class="o">,</span> <span class="mi">192</span><span class="o">,</span> <span class="mi">192</span><span class="o">));</span>
            <span class="n">put</span><span class="o">(</span><span class="n">EnumColors</span><span class="o">.</span><span class="na">DARK_GREY</span><span class="o">,</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">64</span><span class="o">,</span> <span class="mi">64</span><span class="o">,</span> <span class="mi">64</span><span class="o">));</span>
            <span class="n">put</span><span class="o">(</span><span class="n">EnumColors</span><span class="o">.</span><span class="na">GREY</span><span class="o">,</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">128</span><span class="o">,</span> <span class="mi">128</span><span class="o">,</span> <span class="mi">128</span><span class="o">));</span>
            <span class="n">put</span><span class="o">(</span><span class="n">EnumColors</span><span class="o">.</span><span class="na">BLACK</span><span class="o">,</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">));</span>
            <span class="n">put</span><span class="o">(</span><span class="n">EnumColors</span><span class="o">.</span><span class="na">WHITE</span><span class="o">,</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">255</span><span class="o">,</span> <span class="mi">255</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">};</span>

    <span class="kt">int</span> <span class="n">red</span><span class="o">,</span><span class="n">green</span><span class="o">,</span><span class="n">blue</span><span class="o">;</span>

    <span class="n">Color</span><span class="o">(</span><span class="kt">int</span> <span class="n">r</span><span class="o">,</span> <span class="kt">int</span> <span class="n">g</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">){</span>
        <span class="n">red</span> <span class="o">=</span> <span class="n">r</span><span class="o">;</span>
        <span class="n">green</span> <span class="o">=</span> <span class="n">g</span><span class="o">;</span>
        <span class="n">blue</span> <span class="o">=</span> <span class="n">b</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="n">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="c1">// 通过 map 提取 Color 类型的对象</span>
        <span class="n">Color</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Color</span><span class="o">.</span><span class="na">colors</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">EnumColors</span><span class="o">.</span><span class="na">BLUE</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>我必须承认这三个方法毫不简便，但是第一段我们可以看到 enum 的拓展性。
修改构造方法，重写原有方法，添加新方法都没有任何问题，
第二段我们能看到 enum 与 switch 的组合使用。
第三段是我对于 EnumMap 的强行展示（笑）希望各位能看懂（看不懂也没有任何卵子关系）。
至于他能实现怎样的功能，就看各位自行发挥了。</p>

<p>这样看来，要想用 enum 来替代常量，不仅在开始写的时候要多一些内容，
而且还会增加调用时候的复杂性，所以未必是个好方法。相反地， enum 的优势在于：</p>

<ol>
<li>所有值由特有的名称区分，不易混淆</li>
<li>可用内容在声明时就已经规定，可以规避非法参数的出现</li>
<li>丰富的的拓展性，包括 EnumMap, EnumSet 的支持，以及 iterable 等接口的支持</li>
</ol>

<h2>enum 的应用 —— 传参与 foreach</h2>

<p>鉴于前文中提到的一和二的优点，enum 其实可以用来做函数的参数。
举个栗子吧，比如我们现在有一个电磁炉，工作时可以有不同的模式。<br>
如果不用 enum， 我们大概会这样写：</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">System</span><span class="o">.*;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Oven</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">WORK_MODE_LOW</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">WORK_MODE_MID</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">WORK_MODE_HIGH</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="n">cook</span><span class="o">(</span><span class="kt">int</span> <span class="n">mode</span><span class="o">){</span>
        <span class="n">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"Working in "</span><span class="o">);</span>
        <span class="k">switch</span> <span class="o">(</span><span class="n">mode</span><span class="o">){</span>
            <span class="k">case</span> <span class="nl">WORK_MODE_LOW:</span> <span class="n">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"LOW mode"</span><span class="o">);</span> <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="nl">WORK_MODE_MID:</span> <span class="n">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"MID mode"</span><span class="o">);</span> <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="nl">WORK_MODE_HIGH:</span> <span class="n">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"HIGH mode"</span><span class="o">);</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="n">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">Oven</span> <span class="n">oven</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Oven</span><span class="o">();</span>
        <span class="n">oven</span><span class="o">.</span><span class="na">cook</span><span class="o">(</span><span class="n">WORK_MODE_MID</span><span class="o">);</span>  <span class="c1">// 输出 Working in MID mode</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>上边大概不用我写注释了吧（笑）。有了 enum 之后， 我们可以这样写：</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">System</span><span class="o">.*;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Oven</span> <span class="o">{</span>
    <span class="kd">enum</span> <span class="n">CookMode</span><span class="o">{</span><span class="n">LOW</span><span class="o">,</span> <span class="n">MID</span><span class="o">,</span> <span class="n">HIGH</span><span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="n">cook</span><span class="o">(</span><span class="n">CookMode</span> <span class="n">mode</span><span class="o">){</span>
        <span class="n">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"Working in "</span> <span class="o">+</span> <span class="n">mode</span> <span class="o">+</span> <span class="s">" mode!"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="n">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">Oven</span> <span class="n">oven</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Oven</span><span class="o">();</span>
        <span class="n">oven</span><span class="o">.</span><span class="na">cook</span><span class="o">(</span><span class="n">CookMode</span><span class="o">.</span><span class="na">MID</span><span class="o">);</span>  <span class="c1">// 输出 Working in MID mode!</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>有木有觉得超爽的说！</p>

<p>另外，Enum 的实例具有 values() 方法，这个方法会返回 enum 所有取值的集合。
说道这里有没有想到什么？集合是可以丢到 foreach 里边循环的！
所以，我们还可以这样玩儿：</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">System</span><span class="o">.*;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Oven</span> <span class="o">{</span>
    <span class="kd">enum</span> <span class="n">CookMode</span><span class="o">{</span><span class="n">LOW</span><span class="o">,</span> <span class="n">MID</span><span class="o">,</span> <span class="n">HIGH</span><span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="n">cook</span><span class="o">(</span><span class="n">CookMode</span> <span class="n">mode</span><span class="o">){</span>
        <span class="n">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Working in "</span> <span class="o">+</span> <span class="n">mode</span> <span class="o">+</span> <span class="s">" mode!"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="n">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">Oven</span> <span class="n">oven</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Oven</span><span class="o">();</span>
        <span class="k">for</span><span class="o">(</span><span class="n">CookMode</span> <span class="n">mode</span> <span class="o">:</span> <span class="n">CookMode</span><span class="o">.</span><span class="na">values</span><span class="o">()){</span>
            <span class="n">oven</span><span class="o">.</span><span class="na">cook</span><span class="o">(</span><span class="n">mode</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/**
 * 输出结果：
 * Working in LOW mode!
 * Working in MID mode!
 * Working in HIGH mode!
 */</span>

</code></pre></div>
<p>看到这儿，有没有突然发现 enum 还是有点意思的。
本人才疏学浅，就不继续献丑了。</p>

<hr>

<p>参考文献：<br>
<a href="http://blog.csdn.net/brockliu1010/article/details/12440019">匿名内部类构造函数</a><br>
<a href="http://www.cnblogs.com/happyPawpaw/archive/2013/04/09/3009553.html">Java enum的用法详解 by rhino</a></p>

		    <p>
		    <a class="text" href="/blog/usage-of-enum-in-java/">
		      Continue Reading...
		    </a>
		    </p>
		  
		  </div>
		</div>
        

    
</div>
</div>

    		</div> <!-- #et-main-area -->
		</div> <!-- #page-container -->
    <!-- Go to www.addthis.com/dashboard to customize your tools -->
    <div class="addthis_sharing_toolbox" align="center"></div>
		
<script src="/js/katex_init.js"></script>



<footer id="page-footer-trans" class="page-footer">
	<!--<p class="text"><a href="https://yoursite.com">Towdium</a> 
</p>-->
	Copyright &copy; 2016 <a href="https://yoursite.com">Towdium</a> 
 All Rights Reserved. 
	<p class="text">Hosted by <a href="https://github.com">GitHub</a>. Theme created by <a href="https://github.com/fengzhichu/fengzhichu-theme/tree/gh-pages">枫之楚</a></p>
</footer>


    
<!-- WP Audio player plugin v1.9.3 - https://www.tipsandtricks-hq.com/wordpress-audio-music-player-plugin-4556/ -->
    <script type="text/javascript">
        soundManager.useFlashBlock = true; // optional - if used, required flashblock.css
        soundManager.url = '/plugins/soundmanager2.swf';
        function play_mp3(flg, ids, mp3url, volume, loops)
        {
            //Check the file URL parameter value
            var pieces = mp3url.split("|");
            if (pieces.length > 1) {//We have got an .ogg file too
                mp3file = pieces[0];
                oggfile = pieces[1];
                //set the file URL to be an array with the mp3 and ogg file
                mp3url = new Array(mp3file, oggfile);
            }

            soundManager.createSound({
                id: 'btnplay_' + ids,
                volume: volume,
                url: mp3url
            });

            if (flg == 'play') {
                    soundManager.play('btnplay_' + ids, {
                    onfinish: function() {
                        if (loops == 'true') {
                            loopSound('btnplay_' + ids);
                        }
                        else {
                            document.getElementById('btnplay_' + ids).style.display = 'inline';
                            document.getElementById('btnstop_' + ids).style.display = 'none';
                        }
                    }
                });
            }
            else if (flg == 'stop') {
    //soundManager.stop('btnplay_'+ids);
                soundManager.pause('btnplay_' + ids);
            }
        }
        function show_hide(flag, ids)
        {
            if (flag == 'play') {
                document.getElementById('btnplay_' + ids).style.display = 'none';
                document.getElementById('btnstop_' + ids).style.display = 'inline';
            }
            else if (flag == 'stop') {
                document.getElementById('btnplay_' + ids).style.display = 'inline';
                document.getElementById('btnstop_' + ids).style.display = 'none';
            }
        }
        function loopSound(soundID)
        {
            window.setTimeout(function() {
                soundManager.play(soundID, {onfinish: function() {
                        loopSound(soundID);
                    }});
            }, 1);
        }
        function stop_all_tracks()
        {
            soundManager.stopAll();
            var inputs = document.getElementsByTagName("input");
            for (var i = 0; i < inputs.length; i++) {
                if (inputs[i].id.indexOf("btnplay_") == 0) {
                    inputs[i].style.display = 'inline';//Toggle the play button
                }
                if (inputs[i].id.indexOf("btnstop_") == 0) {
                    inputs[i].style.display = 'none';//Hide the stop button
                }
            }
        }
    </script>
    <script type='text/javascript' src="/js/frontend-builder-global-functions.js"></script>
<script type='text/javascript' src="/js/custom.js"></script>
<script type='text/javascript' src="/js/jquery.fitvids.js"></script>
<script type='text/javascript' src="/js/waypoints.min.js"></script>
<script type='text/javascript' src="/js/jquery.magnific-popup.js"></script>
<script type='text/javascript'>
/* <![CDATA[ */
var et_custom = {"ajaxurl":"http:\/\/blog.ibireme.com\/wp-admin\/admin-ajax.php","images_uri":"http:\/\/blog.ibireme.com\/wp-content\/themes\/Divi\/images","builder_images_uri":"http:\/\/blog.ibireme.com\/wp-content\/themes\/Divi\/includes\/builder\/images","et_load_nonce":"ae39988568","subscription_failed":"Please, check the fields below to make sure you entered the correct information.","fill":"Fill","field":"field","invalid":"Invalid email","captcha":"Captcha","prev":"Prev","previous":"\u4e0a\u4e00\u9875","next":"\u4e0b\u4e00\u9875","is_builder_plugin_used":""};
/* ]]> */
</script>
<script type='text/javascript' src="/js/frontend-builder-scripts.js"></script>
    
  </body>
</html>
